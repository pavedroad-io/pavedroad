# Document Generation

Markdown documentation files provided by PavedRoad such as README.md files are generated
from templates using jinja2.
The template files may be edited with any editor including the GitHub GUI editor available
on repository web pages.

Once template files have been edited the target markdown files must be generated by running
the specific _make_ command in the appropriate directory.
After the generated file is ready for prime time both it and the template should be pushed
to a branch and a pull request made.

## Getting Started

If the template file and the target file already exist the process for updating a file
is fairly simple.
Edit the template file and go to the directory *pavedroad/assets/build* and run _make_.
All target files that have had any dependencies modified will be rebuilt.

## Directory Layout

    |-- pavedroad
        |-- assets
        |   |-- build
        |   |   |-- assets
        |   |   |-- github
        |   |   |-- pavedroad
        |   |   `-- devkit
        |   |-- images
        |   `-- templates
        |       |-- assets
        |       |---default
        |       `-- devkit
        `-- devkit

Each set of generated markdown files in a target directory have an associated
template directory where the source templates reside.
The source template file for each generated file has the same base name.
In addition a third directory is associated with each pair of template and target directories.
This third directory contains the Makefile used to generate this set of target markdown files.
Generally the last path element of all of these directory names would be the same.
As an example here are the directories and files associated with the
devkit directory README.md file:

|Directory Type|Example Files|
|:-|:-|
|template|pavedroad/assets/templates/devkit/README.md|
|target|pavedroad/devkit/README.md|
|makefile|pavedroad/assets/build/devkit/Makefile|

### The Target Directory

A target directory may reside anywhere on GitHub but target file generation is much simpler
if it is in the same repo or the same organization.
Note that all three directories are in the same repo for the example of this README file.

### The Template Directory

A template directory generally resides in *pavedroad/assets/templates* and usually
would have the same last path element directory name.
However, different target directories could share the same template directory so
both of these directories are not required to have the same name.
If all of the template files in a template directory are used to generate
markdown files in one specific target directory
it is good practice to give the directories the same name.

### The Makefile Directory

A makefile directory must reside in *pavedroad/assets/build* and usually would have
the same last path element directory name as the target and template directories.
Running _make_ in this directory will build all of its target markdown files that are out of date.
Note that all three directories have the same last path element name of *assets* in
the example of this README file.

The required files in a makefile directory are _Makefile_ and _project.yaml_.
The Makefile must have the two directory variables set: *target_dir* and *template_dir*
in order to find the target and template markdown files.
The _project.yaml_ file must contain any project specific jinja variable settings.
All other files in the directory are dependency files created by running _make_.

Generally all of the template files in a template directory are used to generate
markdown files in one specific target directory.
However, different target directories could share the same template directory.
Each Makefile determines a specific target directory and a specific template directory.
This allows template files to be used to generate multiple target files using
different values for the jinja variables.

### The Build Directory

All of the makefile directories reside in *pavedroad/assets/build* and this directory
has a top level Makefile that can start makes in all of its sub directories.
Running _make_ or _make all_ in this directory will build all of the target markdown files
that are out of date in each target directory.
To make only the targets on one or more sub directories run _make_ with the names
of the target directories.
In the above example for the devkit directory README.md file one would run _make devkit_
in the build directory.

### Template Variables

Template variable files define the substitutions that are made to jinja
variables when the template files are processed.
Two types of template variables are defined: organization and project.
Only one organization variable file exits and multiple project variable files exist.

|Variable Type|Directory|File Name|Applies To|
|:-|:-|:-|:-|
|Organization|pavedroad/assets/build|organization.yaml|All target directory templates
|Project|pavedroad/assets/build/_target_|project.yaml|Single target directory templates

Continuing the example above here are the variable files associated with the
devkit directory README.md file:

|Variable Type|Example Files|
|:-|:-|
|Organization|pavedroad/assets/build/organization.yaml|
|Project|pavedroad/assets/build/devkit/project.yaml|

## Adding a New Markdown File

Three directories must already exist, the target directory
and the associated template and makefile directories.
To add a mew markdown file it is as simple as adding two new files.
An empty target file must be created in the target directory and the source
template file with the same name must be created in the template directory.
This file name must have the _md_ extension as the Makefile attempts to build
all of the markdown files in the target directory based on the _md_ extension.
No changes need to be made to any Makefile.

## Adding New Markdown Directories

The target directory may already exist with no markdown files in it or it may be created.
Then the associated template and makefile directories must be created.
See the sections above for the names and locations of the associated directories.
The template directory will only contain the new markdown template files.
The makefile directory must contain _Makefile_ and _project.yaml_.
The simplest way to do this is to copy these two files from the _devkit_ directory
and edit them.
The _project.yaml_ file must contain any project specific jinja variable settings.
See the makefile section above for the descriptions of these files.
No changes need to be made to the Makefile in the build directory.
The Makefile in the build directory runs the Makefile in all sub directories of
the build directory.

## Links to More Information

### Getting Help
For contact information or to report a bug see [Support](https://github.com/pavedroad-io/pavedroad/blob/master/SUPPORT.md).
### How to Contribute
For guidelines on contributions see [Contributing](https://github.com/pavedroad-io/pavedroad/blob/master/CONTRIBUTING.md).
### Code of Conduct
This project follows this [Code of Conduct](https://github.com/pavedroad-io/pavedroad/blob/master/CODE_OF_CONDUCT.md).
### License
This project is licensed under the following [License](https://github.com/pavedroad-io/pavedroad/blob/master/LICENSE).

